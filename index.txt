<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…·åè¡¨æ±ºå™¨</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { margin: 0; font-family: sans-serif; text-align: center; background: #f4f4f9; }
        .btn-container { display: flex; height: 50vh; }
        .btn { flex: 1; display: flex; align-items: center; justify-content: center; color: white; font-size: 2.5rem; cursor: pointer; border: none; }
        .pro { background: #28a745; }
        .con { background: #dc3545; }
        .result-section { padding: 20px; }
        .vote-list { text-align: left; max-width: 500px; margin: 20px auto; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .vote-item { padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
        .tag { padding: 2px 8px; border-radius: 4px; color: white; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="btn-container">
        <button class="btn pro" onclick="submitVote('è´Šæˆ')">ğŸ‘ è´Šæˆ</button>
        <button class="btn con" onclick="submitVote('åå°')">ğŸ‘ åå°</button>
    </div>

    <div class="result-section">
        <h2 id="total-text">ç¸½ç¥¨æ•¸ï¼š0 ç¥¨</h2>
        <div class="vote-list" id="vote-list">
            <strong>æŠ•ç¥¨æ˜ç´°ï¼š</strong>
            </div>
    </div>

    <script>
        // --- è«‹è²¼å…¥ä½ çš„ Firebase Config ---
        const firebaseConfig = {
            apiKey: "AIzaSyDvS-8vOwps8G3QgsM34qTh80pUiEPzZ0E",
            databaseURL: "https://cssc-vote-app-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "cssc-vote-app"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('detailed_votes');

        function submitVote(choice) {
            if(localStorage.getItem('voted_name')) {
                alert("ä½ å·²ç¶“æŠ•éç¥¨äº†ï¼");
                return;
            }

            let name = prompt("è«‹è¼¸å…¥æ‚¨çš„å§“åä»¥é€²è¡ŒæŠ•ç¥¨ï¼š");
            if (!name || name.trim() === "") {
                alert("å¿…é ˆè¼¸å…¥å§“åæ‰èƒ½æŠ•ç¥¨å–”ï¼");
                return;
            }

            // å°‡å§“åèˆ‡é¸æ“‡å­˜å…¥é›²ç«¯
            db.push({
                name: name,
                choice: choice,
                timestamp: Date.now()
            }).then(() => {
                localStorage.setItem('voted_name', name);
                alert("æŠ•ç¥¨æˆåŠŸï¼");
            });
        }

        // ç›£è½ä¸¦é¡¯ç¤ºçµæœ
        db.on('value', (snapshot) => {
            const listDiv = document.getElementById('vote-list');
            listDiv.innerHTML = "<strong>æŠ•ç¥¨æ˜ç´°ï¼š</strong>";
            let count = 0;

            snapshot.forEach((childSnapshot) => {
                const data = childSnapshot.val();
                count++;
                const color = data.choice === 'è´Šæˆ' ? '#28a745' : '#dc3545';
                
                listDiv.innerHTML += `
                    <div class="vote-item">
                        <span>${data.name}</span>
                        <span class="tag" style="background:${color}">${data.choice}</span>
                    </div>
                `;
            });
            document.getElementById('total-text').innerText = `ç¸½ç¥¨æ•¸ï¼š${count} ç¥¨`;
        });
    </script>
</body>
</html>
